name: readme/build
on: [pull_request]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@master
    - run: make readme/deps
    - run: make readme
    - run: git config user.name "$(git --no-pager log --format=format:'%an' -n 1)"
    - run: git config user.email "$(git --no-pager log --format=format:'%ae' -n 1)"
    - run: git remote set-url origin "https://${GITHUB_ACTOR}:${{secrets.GITHUB_TOKEN}}@github.com/${GITHUB_REPOSITORY}.git"
    - run: git remote -v
    - run: git status
    - run: git diff
    - run: git add .
    - run: git commit -m "Updated README"
    - run: git push origin HEAD:${GITHUB_REF} --force

